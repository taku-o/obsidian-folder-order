# UI/UX設計書 - Obsidian Folder Order Plugin

## 1. 設計原則

### 1.1 基本方針
- **Obsidianとの統一性**: 既存のObsidianUIとの視覚的・操作的統一
- **シンプルさ**: 複雑な操作を避け、直感的な操作性を重視
- **アクセシビリティ**: キーボード操作とスクリーンリーダー対応
- **パフォーマンス**: 大量のフォルダでも快適な操作感

### 1.2 ユーザビリティ原則
- **認知負荷の軽減**: 現在の状態が一目で分かる
- **予測可能性**: 操作結果が予測しやすい
- **即座のフィードバック**: 操作に対する即座の反応
- **エラー防止**: 誤操作を防ぐ設計

## 2. 全体的なUI構成

### 2.1 レイアウト構造
```
┌─────────────────────────────────────────────────────────────┐
│                    File Explorer                           │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────┐ │
│  │              Sort Control Menu                         │ │
│  │  [Sort Method ▼] [Direction ↕] [Options ⚙]           │ │
│  └─────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│  📁 Folder A                                              │ │
│  📁 Folder B                                              │ │
│  📁 Folder C                                              │ │
│  📄 File 1.md                                             │ │
│  📄 File 2.md                                             │ │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 配色とスタイル
- **プライマリカラー**: Obsidianのテーマカラーに準拠
- **セカンダリカラー**: アクセントカラーは控えめに使用
- **背景色**: 既存のファイルエクスプローラーと統一
- **フォント**: Obsidianの標準フォント設定を継承

## 3. ソート制御メニュー

### 3.1 メニューの配置
```
┌─────────────────────────────────────────────────────────────┐
│  Files                                              [×] [⚙] │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  Sort: [Name ↑↓] [Date ↑↓] [Custom] [Default]         │ │
│  └─────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│  📁 Project A                                             │ │
│  📁 Project B                                             │ │
```

### 3.2 ソート方式選択UI

#### 3.2.1 コンパクトモード（デフォルト）
```
┌─────────────────────────────────────────────────────────────┐
│  Sort by: [Name (A→Z) ▼]                           [⚙]     │
└─────────────────────────────────────────────────────────────┘
```

#### 3.2.2 詳細モード
```
┌─────────────────────────────────────────────────────────────┐
│  Sort by:                                                   │
│  ○ Name (A→Z)     ● Name (Z→A)                            │
│  ○ Modified (↑)   ○ Modified (↓)                          │
│  ○ Created (↑)    ○ Created (↓)                           │
│  ○ Custom Order   ○ Default                               │
└─────────────────────────────────────────────────────────────┘
```

### 3.3 ドロップダウンメニュー
```
┌─────────────────────────────────────────────────────────────┐
│  Sort by: [Name (A→Z) ▼]                                   │
└─────────────────────────────────────────────────────────────┘
                   ↓
┌─────────────────────────────────────────────────────────────┐
│  ● Name (A→Z)                                              │
│  ○ Name (Z→A)                                              │
│  ○ Modified (Newest)                                       │
│  ○ Modified (Oldest)                                       │
│  ○ Created (Newest)                                        │
│  ○ Created (Oldest)                                        │
│  ○ Custom Order                                            │
│  ○ Default                                                 │
└─────────────────────────────────────────────────────────────┘
```

## 4. 視覚的フィードバック

### 4.1 ソート状態インジケーター
```
📁 Folder A                                              [↑]
📁 Folder B                                              [↑]
📁 Folder C                                              [↑]
───────────────────────────────────────────────────────────────
📄 File 1.md
📄 File 2.md
```

### 4.2 ローディング状態
```
┌─────────────────────────────────────────────────────────────┐
│  Sort by: [Name (A→Z) ▼]                   [⟳ Sorting...]  │
└─────────────────────────────────────────────────────────────┘
```

### 4.3 エラー状態
```
┌─────────────────────────────────────────────────────────────┐
│  Sort by: [Name (A→Z) ▼]                   [⚠ Error]       │
└─────────────────────────────────────────────────────────────┘
```

## 5. インタラクションデザイン

### 5.1 マウス操作
- **クリック**: ソート方式の変更
- **ホバー**: ツールチップ表示
- **右クリック**: コンテキストメニュー（将来拡張）

### 5.2 キーボード操作
- **Tab**: フォーカス移動
- **Enter/Space**: 選択実行
- **↑/↓**: ドロップダウンメニューの選択
- **Esc**: メニューを閉じる

### 5.3 タッチ操作（モバイル）
- **タップ**: ソート方式の変更
- **ロングタップ**: 設定メニュー表示
- **スワイプ**: 将来拡張（クイックソート）

## 6. レスポンシブデザイン

### 6.1 デスクトップ版
```
┌─────────────────────────────────────────────────────────────┐
│  Sort: [Name (A→Z) ▼] [Direction ↕] [Options ⚙]           │
└─────────────────────────────────────────────────────────────┘
```

### 6.2 モバイル版
```
┌─────────────────────────────────────────────────────────────┐
│  Sort: [Name (A→Z) ▼]                               [⚙]    │
└─────────────────────────────────────────────────────────────┘
```

### 6.3 幅による適応
- **幅 > 600px**: 完全なメニュー表示
- **幅 400-600px**: 簡略化されたメニュー
- **幅 < 400px**: アイコンのみ表示

## 7. アニメーション

### 7.1 ソート実行時
```css
.folder-sort-animation {
  transition: transform 0.3s ease-in-out;
}

.folder-item {
  animation: slideIn 0.2s ease-out;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
```

### 7.2 メニュー開閉
```css
.sort-dropdown {
  animation: fadeIn 0.15s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
```

## 8. 設定画面

### 8.1 プラグイン設定タブ
```
┌─────────────────────────────────────────────────────────────┐
│  Folder Order Settings                                      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  General Settings                                           │
│  ☑ Show sort menu in file explorer                         │
│  ☑ Remember last used sort method                          │
│                                                             │
│  Default Sort Method                                        │
│  ○ Name (A→Z)     ● Name (Z→A)                            │
│  ○ Modified (↑)   ○ Modified (↓)                          │
│  ○ Created (↑)    ○ Created (↓)                           │
│                                                             │
│  Advanced Settings                                          │
│  ☑ Exclude system folders (.obsidian, .trash)             │
│  ☐ Enable custom sort order                               │
│                                                             │
│  Exclude Patterns                                           │
│  ┌─────────────────────────────────────────────────────┐     │
│  │  ^\..*$                                           │     │
│  │  temp/.*                                          │     │
│  │  [Add Pattern]                                    │     │
│  └─────────────────────────────────────────────────────┘     │
│                                                             │
│  [Save Settings]  [Reset to Default]                       │
└─────────────────────────────────────────────────────────────┘
```

### 8.2 設定項目の説明
- **ツールチップ**: 各設定項目にヘルプテキスト
- **検証**: 無効な設定値の即座の検出
- **プレビュー**: 設定変更の即座のプレビュー

## 9. エラーハンドリング

### 9.1 エラー表示
```
┌─────────────────────────────────────────────────────────────┐
│  ⚠ Unable to sort folders                                   │
│  The folder structure may be corrupted. [Try Again] [Help] │
└─────────────────────────────────────────────────────────────┘
```

### 9.2 警告表示
```
┌─────────────────────────────────────────────────────────────┐
│  ⚠ Large number of folders detected                         │
│  Sorting may take a moment. [Continue] [Cancel]            │
└─────────────────────────────────────────────────────────────┘
```

## 10. アクセシビリティ

### 10.1 スクリーンリーダー対応
```html
<div role="toolbar" aria-label="Folder sorting controls">
  <button aria-label="Sort by name, currently ascending" 
          aria-pressed="true">
    Name (A→Z)
  </button>
  <button aria-label="Sort by modified date" 
          aria-pressed="false">
    Modified
  </button>
</div>
```

### 10.2 キーボードナビゲーション
- **Tab順序**: 論理的な順序での移動
- **フォーカス表示**: 明確なフォーカス可視化
- **ショートカット**: 主要機能へのキーボードショートカット

### 10.3 カラーアクセシビリティ
- **コントラスト**: WCAG AA基準の遵守
- **色覚障害対応**: 色だけに頼らない情報伝達
- **ダークモード**: 暗いテーマでの適切な表示

## 11. パフォーマンス考慮

### 11.1 UI応答性
- **レンダリング最適化**: 必要な部分のみの再描画
- **仮想化**: 大量アイテムの効率的な表示
- **デバウンシング**: 連続する操作の制御

### 11.2 メモリ使用量
- **リソース管理**: 適切なイベントリスナーの削除
- **キャッシュ**: 効率的なキャッシュ戦略
- **リーク防止**: メモリリークの防止

## 12. ユーザーテスト計画

### 12.1 テスト項目
1. **基本操作**: ソート方式の変更
2. **設定**: 設定画面での操作
3. **エラー処理**: エラー状況での動作
4. **パフォーマンス**: 大量フォルダでの動作
5. **アクセシビリティ**: キーボード操作とスクリーンリーダー

### 12.2 テストシナリオ
- **新規ユーザー**: 初回使用時の体験
- **既存ユーザー**: 日常的な使用パターン
- **パワーユーザー**: 高度な設定の使用
- **モバイルユーザー**: タッチ操作での使用

### 12.3 成功指標
- **完了率**: タスクの完了率 > 90%
- **時間**: 基本操作完了時間 < 5秒
- **エラー率**: 誤操作発生率 < 5%
- **満足度**: ユーザー満足度スコア > 4.0/5.0

## 13. 将来的な拡張

### 13.1 高度なUI機能
- **ドラッグ&ドロップ**: カスタムソート順の視覚的編集
- **コンテキストメニュー**: 右クリックでの操作
- **プレビュー**: ソート結果のプレビュー表示

### 13.2 カスタマイゼーション
- **テーマサポート**: ユーザーカスタムテーマ対応
- **レイアウト選択**: 異なるレイアウトオプション
- **アイコンカスタマイズ**: フォルダアイコンの変更

### 13.3 統合機能
- **他プラグイン連携**: File Tree Alternativeとの統合
- **コマンドパレット**: コマンドパレットからの操作
- **ホットキー**: カスタムホットキー設定